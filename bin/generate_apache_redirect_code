#!/usr/bin/env ruby
#
# generate_apache_redirect_code [old] [new]
#

require 'optparse'
require 'redirect_code_generator/version'
require 'redirect_code_generator/generator/apache'
permanent = true
escape = true
print_version = false

opt = OptionParser.new
opt.on('--[no-]permanent', 'Use permanent redirect') { |_| permanent = _ }
opt.on('--[no-]escape', 'Escape any characters') { |_| escape = _ }
opt.on('-v', '--version', 'Print version') { |_| print_version = true }

args = opt.parse(ARGV)

if print_version
  puts "generate_apache_redirect_code #{RedirectCodeGenerator::VERSION}"
  exit 0
end

old = args.shift
new = args.shift
if old.nil? || new.nil?
  puts "Usage: generate_apache_redirect_code [old] [new] -options"
  exit 1
end

generator = RedirectCodeGenerator::Generator::Apache.new(old, new, permanent, escape)
puts generator.create_redirect_code
